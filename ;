import { SingleColumn } from "@/components/layout/single-column";
import { authClient } from "@/lib/auth-client";
import { Button } from "@hoalu/ui/button";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@hoalu/ui/card";
import { Input } from "@hoalu/ui/input";
import { Label } from "@hoalu/ui/label";
import { createFileRoute, redirect } from "@tanstack/react-router";

export const Route = createFileRoute("/onboarding")({
	beforeLoad: async ({ context: { user } }) => {
		if (!user) {
			throw redirect({ to: "/login" });
		}
	},
	component: RouteComponent,
});

function RouteComponent() {
	return (
		<SingleColumn>
			<div className="flex flex-col gap-6">
				<Card>
					<CardHeader className="text-center">
						<CardTitle className="text-xl">Welcome back</CardTitle>
						<CardDescription>Log in to your Hoalu account</CardDescription>
					</CardHeader>
					<CardContent>
						<form action={formAction}>
							<div className="grid gap-6">
								<div className="flex flex-col gap-4">
									<Button variant="outline" className="w-full">
										Continue with Google
									</Button>
								</div>
								<div className="relative text-center text-sm after:absolute after:inset-0 after:top-1/2 after:z-0 after:flex after:items-center after:border-border after:border-t">
									<span className="relative z-10 bg-background px-2 text-muted-foreground">or</span>
								</div>
								<div className="grid gap-6">
									<div className="grid gap-2">
										<Label htmlFor="email">Email</Label>
										<Input id="email" name="email" type="email" required />
									</div>
									<div className="grid gap-2">
										<Label htmlFor="password">Password</Label>
										<Input id="password" name="password" type="password" required />
										<div>
											<Link
												to="/"
												preload={false}
												className="text-sm underline-offset-4 hover:underline"
											>
												Forgot password?
											</Link>
										</div>
									</div>
									<Button type="submit" className="w-full">
										Log In
									</Button>
								</div>
								<div className="text-center text-sm">
									Don&apos;t have an account?{" "}
									<Link to="/signup" className="underline underline-offset-4">
										Sign up
									</Link>
								</div>
							</div>
						</form>
					</CardContent>
				</Card>
			</div>
		</SingleColumn>
	);
}
